<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS 280A: Intro to Computer Vision and Computational Photography, Fall 2024</title>
    <script type="text/javascript" id="MathJax-script" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            color: #333;
        }
        h1 {
            font-size: 2em;
            text-align: center;
        }
        h2 {
            font-size: 1.7em;
            color: #333;
        }
        h3 {
            font-size: 1.4em;
            color: #666;
        }
        h4 {
            font-size: 1.2em;
            color: #666;
        }
        .container {
            width: 80%;
            margin: auto;
            overflow: hidden;
            text-align: justify;
            padding: 20px;
        }
        .header-info {
            text-align: center;
            margin-bottom: 20px;
        }
        .images-container {
            display: flex;
            justify-content: space-between;
            gap: 20px; 
            margin-top: 20px;
        }
        .img-container {
            width: 30%;
            text-align: center;
        }
        .smaller-img-container {
            width: 25%;
            text-align: center;
        }
        .gif-container {
            text-align: center;
            margin-top: 20px;
        }

        img {
            width: 100%;
            max-width: 500px;
            height: auto;
        }
        .smaller-img img{
            width: 30%;
            max-width: 300px;
        }
        .caption {
            font-size: 1.2em;
        }
        p, li{
            font-size: 1.3em;
            margin-top: 0.5em;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <div class="header-info">
        <h1>CS 280A: Intro to Computer Vision and Computational Photography, Fall 2024</h1>
        <h1>Project 3: Face Morphing</h1>
        <h2>Jasper Liu</h2>
    </div>
    
    <div class="container">
        <article>
            <h2>Overview</h2>
            <p>In this project, I morphed my face into someone else's, find found the average face of a female and male, and make caricatures.</p>

            <h2>Part 1: Defining Correspondences</h2>
            <p>In this part, I marked key points on both my face and George's face using ginput in Python to save them. I selected a total of 60 points, plus 4 corners. 
                Then, I generated a Delaunay triangulation for the corresponding points.</p>

            <div class="images-container">
                <div class="img-container">
                    <img src="./output/jasper_tri.png" alt="Gradient X">
                    <p class="caption">Jasper</p>
                </div>
                <div class="img-container">
                    <img src="./output/george_tri.png" alt="Gradient Y">
                    <p class="caption">George</p>
                </div>
            </div>

           
            <h2>Part 2. Computing the "Mid-way Face"</h2>
            <p>To compute the mid-way face of two different faces:</p>
            <ol>
                <li>Average Shape: Calculate the average positions of key points from both faces. </li>
                <li>Warping: Use an affine transformation to morph each triangle from the original face into the shape of the corresponding triangle in the average shape. This can be done using skimage.draw.polygon to handle the triangles efficiently.</li>
                <li>Cross-Dissolving: Blend the colors from both warped images with linear interpolation to get the final look.</li>
            </ol>
            <div class="images-container">
                <div class="img-container">
                    <img src="./data/jasper.jpg" alt="Jasper">
                    <p class="caption">Jasper</p>
                </div>
                <div class="img-container">
                    <img src="./output/warped_image.png" alt="Jasper-George Midway">
                    <p class="caption">Jasper-George Midway</p>
                </div>
                <div class="img-container">
                    <img src="./data/george.jpg" alt="George">
                    <p class="caption">George</p>
                </div>
            </div>  
            <p>
                The outside hair is not merged very well in the mid-way face. Probably because the hairstyles are different, and I didn't choose too many keypoints on the hair.
            </p>

            <h2>Part 3. The Morph Sequence</h2>
            <p>To create the morph sequence, I used the outputs from Part 2 with a range of weights in [0, 1]. 
                I generated 45 frames for the morph sequence.</p>
            <div class="gif-container">
                <img src="./output/morph_sequence.gif" alt="Morphing GIF" width="500">
            </div>
            
            <h2>Part 4. The "Mean face" of a population</h2>
            <p>
                In this section, I analyzed a dataset of facial images to determine average face shapes. 
                The dataset consists of 400 images: 100 male faces, 100 smiling male faces, 100 female faces, and 100 smiling female faces. I also transformed individual faces in the dataset to match this average shape and displayed these transformations. 
                Additionally, I morphed my face and the average face into each other.
            </p>
            
            <div class="images-container">
                <div class="img-container">
                    <img src="./output/average_face.png" alt="Average Face">
                    <p class="caption">Average Face</p>
                </div>
                <div class="img-container">
                    <img src="./output/morphed_average_face.png" alt="Morphed Average Face">
                    <p class="caption">Morphed Average Face</p>
                </div>
            </div>    


            <h3>Bells and Whistles</h3>
            <p> I experimented with using color to enhance the image by applying it separately to the high-frequency and low-frequency components, as well as to both combined.
                Overall, I think images with both colored look the best.
            </p>
            <div class="images-container">
                <div class="img-container">
                    <img src="./output/happy_death_oski_hybrid_image_gray.png" alt="All gray">
                    <p class="caption">Gray Image</p>
                </div>
                <div class="img-container">
                    <img src="./output/happy_death_oski_hybrid_image_oski_colored.png" alt="low frequency colored">
                    <p class="caption">Oski (low frequency) colored</p>
                </div>
                <div class="img-container">
                    <img src="./output/happy_death_oski_hybrid_image_happy_death_colored.png" alt="high frequency colored">
                    <p class="caption">Happy death (high frequency) colored</p>
                </div>
                <div class="img-container" >
                    <img src="./output/happy_death_oski_hybrid_image.png" alt="happy_death_oski_hybrid_image">
                    <p class="caption">Both colored</p>
                </div>
            </div>
        
            <h3>Part 2.3: Gaussian and Laplacian Stacks</h3>
            <h4>Gaussian Stack of Apple</h4>
            <div class="images-container">
                <div class="img-container">
                    <img src="./output/apple_gaussian_stack_0.png">
                </div>
                <div class="img-container">
                    <img src="./output/apple_gaussian_stack_1.png">
                </div>
                <div class="img-container" >
                    <img src="./output/apple_gaussian_stack_2.png">
                </div>
                <div class="img-container" >
                    <img src="./output/apple_gaussian_stack_3.png">
                </div>
                <div class="img-container" >
                    <img src="./output/apple_gaussian_stack_4.png">
                </div>
            </div>

            <h4>Gaussian Stack of Orange</h4>
            <div class="images-container">
                <div class="img-container">
                    <img src="./output/orange_gaussian_stack_0.png">
                </div>
                <div class="img-container">
                    <img src="./output/orange_gaussian_stack_1.png">
                </div>
                <div class="img-container" >
                    <img src="./output/orange_gaussian_stack_2.png">
                </div>
                <div class="img-container" >
                    <img src="./output/orange_gaussian_stack_3.png">
                </div>
                <div class="img-container" >
                    <img src="./output/orange_gaussian_stack_4.png">
                </div>
            </div>
            <h4>Laplacian Stack of Apple</h4>
            <div class="images-container">
                <div class="img-container">
                    <img src="./output/apple_laplacian_stack_0.png">
                </div>
                <div class="img-container">
                    <img src="./output/apple_laplacian_stack_1.png">
                </div>
                <div class="img-container" >
                    <img src="./output/apple_laplacian_stack_2.png">
                </div>
                <div class="img-container" >
                    <img src="./output/apple_laplacian_stack_3.png">
                </div>
                <div class="img-container" >
                    <img src="./output/apple_laplacian_stack_4.png">
                </div>
            </div>
            <h4>Laplacian Stack of Orange</h4>
            <div class="images-container">
                <div class="img-container">
                    <img src="./output/orange_laplacian_stack_0.png">
                </div>
                <div class="img-container">
                    <img src="./output/orange_laplacian_stack_1.png">
                </div>
                <div class="img-container" >
                    <img src="./output/orange_laplacian_stack_2.png">
                </div>
                <div class="img-container" >
                    <img src="./output/orange_laplacian_stack_3.png">
                </div>
                <div class="img-container" >
                    <img src="./output/orange_laplacian_stack_4.png">
                </div>
            </div>

            <h3>Blending</h3>
            <p>I applied Gaussian and Laplacian stacks to the "Oraple" image to recreate the results shown in Figure 3.42 of 
                *Computer Vision: Algorithms and Applications* (2nd Edition) by Richard Szeliski, page 167.</p>
            <div class="images-container">
                <div class="img-container">
                    <img src="./output/apple_laplacian_stack_0.png">
                </div>
                <div class="img-container">
                    <img src="./output/im1_stack_0.png">
                </div>
                <div class="img-container" >
                    <img src="./output/blended_0.png">
                    <p class="caption">Level 0</p>
                </div>
                <div class="img-container" >
                    <img src="./output/im2_stack_0.png">
                </div>
                <div class="img-container" >
                    <img src="./output/orange_laplacian_stack_0.png">
                </div>
            </div>

            <div class="images-container">
                <div class="img-container">
                    <img src="./output/apple_laplacian_stack_1.png">
                </div>
                <div class="img-container">
                    <img src="./output/im1_stack_1.png">
                </div>
                <div class="img-container" >
                    <img src="./output/blended_1.png">
                    <p class="caption">Level 1</p>
                </div>
                <div class="img-container" >
                    <img src="./output/im2_stack_1.png">
                </div>
                <div class="img-container" >
                    <img src="./output/orange_laplacian_stack_1.png">
                </div>
            </div>
            <div class="images-container">
                <div class="img-container">
                    <img src="./output/apple_laplacian_stack_2.png">
                </div>
                <div class="img-container">
                    <img src="./output/im1_stack_2.png">
                </div>
                <div class="img-container" >
                    <img src="./output/blended_2.png">
                    <p class="caption">Level 2</p>
                </div>
                <div class="img-container" >
                    <img src="./output/im2_stack_2.png">
                </div>
                <div class="img-container" >
                    <img src="./output/orange_laplacian_stack_2.png">
                </div>
            </div>
            <div class="images-container">
                <div class="img-container">
                    <img src="./output/apple_laplacian_stack_4.png">
                </div>
                <div class="img-container">
                    <img src="./output/im1_stack_3.png">
                </div>
                <div class="img-container" >
                    <img src="./output/blended_3.png">
                    <p class="caption">Level 3</p>
                </div>
                <div class="img-container" >
                    <img src="./output/im2_stack_3.png">
                </div>
                <div class="img-container" >
                    <img src="./output/orange_laplacian_stack_4.png">
                </div>
            </div>

            <div class="images-container">
                <div class="img-container">
                    <img src="./data/apple.jpg">
                </div>
                <div class="img-container">
                    <img src="./output/apple_orange_blended_im1.png">
                </div>
                <div class="img-container" >
                    <img src="./output/apple_orange_blended.png">
                    <p class="caption">Levels Combined</p>
                </div>
                <div class="img-container" >
                    <img src="./output/apple_orange_blended_im2.png">
                </div>
                <div class="img-container" >
                    <img src="./data/orange.jpg">
                </div>
            </div>

            <h3>Part 2.4: Multiresolution Blending (a.k.a. the oraple!)</h3>
            <h4>Orange and Apple => Oraple</h4>
            <div class="images-container">
                <div class="img-container">
                    <img src="./data/apple.jpg">
                    <p class="caption">Apple</p>
                </div>
                <div class="img-container">
                    <img src="./data/orange.jpg">
                    <p class="caption">Orange</p>
                </div>                
                <div class="img-container">
                    <img src="./output/mask_stack_0.png">
                    <p class="caption">Mask</p>
                </div>
                <div class="img-container" >
                    <img src="./output/apple_orange_blended.png">
                    <p class="caption">Oraple</p>
                </div>
            </div>

            <h4>Deadpool + Wolverine => Wolpool</h4>
            <div class="images-container">
                <div class="img-container">
                    <img src="./data/deadpool.png">
                    <p class="caption">Deadpool</p>
                </div>
                <div class="img-container">
                    <img src="./data/wolverine.jpg">
                    <p class="caption">Wolverine</p>
                </div>                
                <div class="img-container">
                    <img src="./output/wol_mask_stack_0.png">
                    <p class="caption">Mask</p>
                </div>
                <div class="img-container" >
                    <img src="./output/wol_dead_blended.png">
                    <p class="caption">Wolpool</p>
                </div>
            </div>

            <h4>Banana + Shiba => Shinana (Favorite One)</h4>
            <div class="images-container">
                <div class="img-container">
                    <img src="./data/shiba.png">
                    <p class="caption">Shiba (狗)</p>
                </div>  
                <div class="img-container">
                    <img src="./data/banana.jpg">
                    <p class="caption">Banana (香蕉)</p>
                </div>
                <div class="img-container">
                    <img src="./data/shiba_mask.png">
                    <p class="caption">Mask</p>
                </div>
                <div class="img-container" >
                    <img src="./output/shiba_banana_blended.png">
                    <p class="caption">Shinana (狗蕉 :>)</p>
                </div>
            </div>
            <div class="images-container">
                <div class="img-container">
                    <img src="./output/shiba_im1_stack_0.png">
                </div>
                <div class="img-container" >
                    <img src="./output/shiba_blended_0.png">
                    <p class="caption">Level 0</p>
                </div>
                <div class="img-container" >
                    <img src="./output/shiba_im2_stack_0.png">
                </div>
            </div>

            <div class="images-container">

                <div class="img-container">
                    <img src="./output/shiba_im1_stack_1.png">
                </div>
                <div class="img-container" >
                    <img src="./output/shiba_blended_1.png">
                    <p class="caption">Level 1</p>
                </div>
                <div class="img-container" >
                    <img src="./output/shiba_im2_stack_1.png">
                </div>
            </div>
            <div class="images-container">
                <div class="img-container">
                    <img src="./output/shiba_im1_stack_2.png">
                </div>
                <div class="img-container" >
                    <img src="./output/shiba_blended_2.png">
                    <p class="caption">Level 2</p>
                </div>
                <div class="img-container" >
                    <img src="./output/shiba_im2_stack_2.png">
                </div>
            </div>

            <div class="images-container">
                <div class="img-container">
                    <img src="./output/shiba_im1_stack_3.png">
                </div>
                <div class="img-container" >
                    <img src="./output/shiba_blended_3.png">
                    <p class="caption">Level 3</p>
                </div>
                <div class="img-container" >
                    <img src="./output/shiba_im2_stack_3.png">
                </div>
            </div>

            <div class="images-container">
                <div class="img-container">
                    <img src="./data/shiba.png">
                </div>  
                <div class="img-container" >
                    <img src="./output/shiba_banana_blended.png">
                    <p class="caption">Levels Combined</p>
                </div>
                <div class="img-container">
                    <img src="./data/banana.jpg">
                </div>
            </div>

            <h2>Reflection</h2>
            <p>The project is pretty fun! I learned a lot about the  image filtering and frequency manipulation techniques. 
               It is pretty cool to blend images and create hybrid images by using Gaussian and Laplacian stacks.
            </p>
            
        </article>
    </div>
</body>
</html>